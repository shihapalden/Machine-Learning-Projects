# -*- coding: utf-8 -*-
"""Logistic Regression for Student Marks and Status Prediction

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1d4Qstr_lYzHVu0YSZnLxNJ9gTkj0kUrm
"""

import pandas as pd
from sklearn.linear_model import LogisticRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from sklearn.preprocessing import LabelEncoder
import matplotlib.pyplot as plt

data = pd.read_excel('studentsmarks.xlsx')
x = data[['Studied Hours', 'Marks']]
y = data['Status']

encoder = LabelEncoder()
y = encoder.fit_transform(y)

X_train, X_test, Y_train, Y_test = train_test_split(x, y, test_size=0.2, random_state=42)

model = LogisticRegression()
#model = LogisticRegression(multi_class='multinomial', solver='lbfgs')
model.fit(X_train, Y_train)

pred = model.predict(X_test)
print(pred)

accuracy = accuracy_score(Y_test, pred)
print("Accuracy Score: ", accuracy)

new = pd.DataFrame(
    {
       'Studied Hours': [1],
       'Marks': [48]
    }
)

prediction = model.predict(new)
print(prediction)

plt.scatter(x['Studied Hours'], x['Marks'], c=y, edgecolors='k', cmap='coolwarm')
plt.xlabel('Studied Hours')
plt.ylabel('Marks')
plt.title('Logistic Regression Decision Boundary')
plt.colorbar(label='Status (0: Fail, 1: Pass)')  # Update the colorbar label
plt.grid()
plt.show()